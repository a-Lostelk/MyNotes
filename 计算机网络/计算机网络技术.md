---
typora-root-url: images
---

## 					计算机网络技术	

### 中国互联网模型	

![](/QQ截图20190908131118.png)

中国互联网是多个运营商组成的网络结构，各个运营商之间的网络是互通的，运营商也有连接Internet的出口连接，因此不同的运营商下的用户可以互相访问，访问Internet外网，也有相应的出口（访问国外网站）



### 网络分类

**局域网（LAN**）：覆盖范围小，带宽固定一般限定在较小的区域内，小于10km的范围，通常采用有线的方式连接起来

**城域网（MAN）**：规模局限在一座城市的范围内，10～100km的区域。

[广域网](https://baike.baidu.com/item/广域网)（WAN）：网络跨越国界、洲界，甚至全球范围。

Internet：

- 局域网和广域网是网络的热点。
- 局域网是组成其他两种类型网络的基础，[城域网](https://baike.baidu.com/item/城域网)一般都加入了广域网
- 广域网的典型代表是**internet**网。
- 个人网：个人局域网就是在个人工作地方把属于个人使用的[电子设备](https://baike.baidu.com/item/电子设备)（如便携电脑等）用[无线技术](https://baike.baidu.com/item/无线技术)连接起来的网络，因此也常称为无线个人局域网WPAN，其范围大约在10m左右



![](/QQ截图20190908132456.png)

**使用某个运营商的带宽带宽服务，速率是访问当前运营商的速度，访问其他运营商或者国外的网站，可能网速会加载缓慢**



![](/QQ截图20190908133551.png)

运营商之间机房的网站地址**统一规划**的，**不能重复**，否则互联网的转发路由器不能转发到指定的网站地址

个人计算机中都配置了**DNS**，浏览器输入网址会发送到**DNS服务器**，DNS服务器会将网站的ip地址返回给个人计算机，计算机发送数据包的时候，**目标地址**就是目标网站的ip地址，

发送的数据包中含有**本机地址**和**目标地址**，计算机的网卡都嵌入了**唯一不重复**的Mac地址，经由多个路由器转发器会携带路由器IP地址，并对数据包进行封装，最终请求到达目标服务器的地址，web服务器无法获取访问者的mac地址（mac地址经由多个路由器进行二次封装），会从发送的数据包中获取到访问者的IP地址（web服务器的数据通过访问者的IP地址确定返回给该用户计算机）



##### 三次握手？？？

web服务器中的数据可能会比较大，会采取**分包切割**的方式返回发送给用户，web服务器会创建一个**缓存区**，将需要发送的数据放进其中，各个数据包根据指定的**编号**逐一发送，经由多个交换机路由器后到达目标计算机，由计算机确定收到后发送一个请求到web服务器确认已经收到数据了，web服务器继续发送接下来的数据包，用户计算机将接受的各个数据包拼凑成**数据包**



### OSI模型

- 应用层：所有能产生网络流量的程序，不产生流量的不属于应用层（记事本，画图等）

- 表示层：在传输之前是否进行压缩处理或是加密（QQ语音和视频等会对数据进行压缩处理，在网络传输的时候更流畅）

- 会话层：它定义了如何开始、控制和结束一个会话，包括对多个双向消息的控制和管理（每一个浏览器窗口都对于着一个会话技术）
- 传输层：选择传输协议发送数据，可靠传输和不可靠传输，包括对传输的数据包控制排序
- 网络层：选择最佳路径，规划IP地址， 为了规划适应相应的传输介质
- 数据链路层：帧的开始和结束，对数据包表示头部和尾部，服务器或是计算机通过头部尾部判断接收开始和结束，透明传输，差错校验
- 物理层：数据传输介质（网线），定义网络设备的接口标准，电气标准（电压），如何在物理链路传输更快的数据

ipv4和ipv6变化的是网络层，其他的层不会改变

#### 网络排错

VLAN虚拟局域网，分配的是假的IP地址

每一个层都是为上一层提供服务，其中一层出现了过程，该层的上一层一级上上一层都会出错故障

物理层： 查看网络连接状态，发送和接受的数据包

数据链路层：mac地址冲突（同一区域的计算机mac地址相同无法上网），ADSL故障（欠费）

网络层：规划地址，配置错误的IP地址，子网掩码，网关地址（网关是数据流量的地址）

应用层：（网络层）



![](/QQ截图20190910083720.png)



#### 数据封装

计算机通讯是**分层处理**的，Web服务器的网页是**应用层**打包成数据，如果数据太大**传输层**进行分片段处理，**网络层**决定IP地址，在数据包包含本地Mac地址和Mac目标地址

FCS校验数据凭证，客户端检验收到的数据是否正确，如果数据丢失会要求重新发送，比如发送快递会有收货单，收货单会表明包裹中包含的物品数量，可以拒收要求重发

![](/QQ截图20190910085114.png)



### 客户进程/服务器进程通信

![](/QQ截图20190910085422.png)

客户端和服务器端家里连接后，中间的数据传输是透明的，用户和服务器都不知道数据传输会经过哪些线路



### 计算机网络的性能

- 速率：连接在计算机网络上的主机在数字信道上传输数据位数，比特率，单位是b/s,kb/s,Mb/s（带宽的速率是按比特来算，计算机中的流量是按字节来计算的，因此计算机网速和带宽速率不一样，10M带宽计算机网速是1m作用）
- 带宽：网络通信领域中，数字信道所能传输的最高数据速率
- 吞吐量：单位时间内，通过某个网络的数据类
- 时延：发送时延，传播时延，处理时延，排队时延

![](/QQ截图20190919142613.png)

- 往返时间：发送方发送数据开始，接受方确认接受数据的时间（A计算机到B计算机的时间）

```cmd
正在 Ping www.a.shifen.com [14.215.177.39] 具有 32 字节的数据:
来自 14.215.177.39 的回复: 字节=32 时间=24ms TTL=53
来自 14.215.177.39 的回复: 字节=32 时间=27ms TTL=53
来自 14.215.177.39 的回复: 字节=32 时间=22ms TTL=53
来自 14.215.177.39 的回复: 字节=32 时间=27ms TTL=53

##百度的平均耗时是比较低的，当访问国外的网站耗时会更高
```

- 利用率

  日常使用的百兆十兆带宽永远无法达到真正的百兆，越接近百兆利用率越高，时延就会急剧无穷增加，会感觉到明显的网络延迟，网络使用率越低，网络使用空间越多，网络条件网速越好，时延也比较低  

  好比是一条马路，车子越多越容易堵，车子越少越快

![](/QQ截图20190919144034.png)



### 物理层的基本概念

并不是指的网线光纤等设备，物理层解决如何在连接各种计算机的传输媒体上传输数据比特流，而不是指具体的传输媒体。
物理层的主要任务描述为:确定传输媒体的接口的一些特性

- 机械特性:例接口形状，大小，引线数目
- 电气特性:例规定电压范围(-5V到+5V)
- 功能特性:例规定-5V表示0，+5V表示1
- 过程特性:也称规程特性，规定建立连接时各个相关部件的工作步骤

#### 数据通信模型

![](/QQ截图20190919145810.png)



##### 数据通信的相关术语

通信的目的是传送消息

数据（data）：传送消息的实体（载体）

信号（signal）：数据的电气和电磁的表现

- “模拟信号”一一代表消息的参数的取值是连续的。

- “数字信号”--代表消息的参数的取值是离散的。

  码元：代表的是数字传输比特流在网络上0101的波形

  码元(code) -- -在使用时间域的波形表示数字信号时，则代表不同离散数值的基本波形就成为码元。

  在数字通信中常常用时间间隔相同的符号来表示一个二进制数字，这样的时间间隔内的信号称为二进制码元。而这个间隔被称为码元长度。1码元可以携带nbit的信息量

#### 信道

表示向一个方向传递信息的媒体，包含发送信息信道和接受信息信道

**单向通信**：只能向一个方向通信没有反方向的交互（电视台传送信号，电视接受，不能反方向电视向电视台发送信号）

**双向交替通信(半双工通信)** - --通信的双方都可以发送信息，但不能双方同时发送(当然也就不能同时接收，对讲机)。

**双向同时通信(全双工通信)** - - -通信的双方可以同时发送和接收信息（电话）。 

计算机通信大多都是半双工或者全双工通信



#### 基带(baseband)信号和带通(band pass)信号

举例，当近距离使用麦克风说话时，听到的是基带信号，空气等介质的影响，声音无法传递很远，通过网络传递给他人会转换成带通信号，由接收端转换说话的声音

**基带信号(即基本频带信号) - -来自信源的信号**。

像计算机输出的代表各种文字或图像文件的数据信号都属于基带信号。基带信号就是发出的直接表达了要传输的信息的信号，比如我们说话的声波就是基带信号

**带通信号**- --

把基带信号经过载波调制后，把信号的频率范围搬移到**较高的频段**以便在信道中传输(即仅在一段频率范围内能够通过信道)。

因此在传输距离较近时，计算机网络都采用**基带传输方式**由于在近距离范围内基带信号的衰减不大，从而信号内容不会发生变化。因此在传输距离较近时，计算机网络都采用基带传输方式。如从计算机到**监视器**、**打印机**等外设的信号就是基带传输的。

#### 调制方式

当基带信号需要传递较远的距离，需要集中调制方式

![](/QQ截图20190919162754.png)

单极性归零码无数据时候表示000，表示000二进制数据也是如此，所有无法判断到底是有数据还是无数据



#### 曼彻斯特编码

![](/QQ截图20190919163900.png)

#### 信道极限容量

有失真，信号干扰，带宽受限，噪声，接收信号波形会发生改变，可能接收端无法解析传输的数据

##### 奈氏准则

1924年，奈奎斯特(Nyquist)就推导出了著名的奈氏准则。他给出了在假定的理想条件下，为了避免码间串扰，码元的传输速率的上限值。
在任何信道中，码元转输的速率是有上限的，否则就会出现码间串扰的问题，使接收端对码元的判决( 即识别)成为不可能，（即使没有外来干扰和信号，码元的发送速度也有上限）。
如果信道的频带越宽，也就是能够通过的信号高频分量越多，那么就可以用更高的速率传送码元而不出现码间串扰。

##### 奈氏准则和香农公式应用范围

![](/QQ截图20190923085818.png)

#### 数据通信的基础知识总结

数据通信模型

信道

基带信号	单工通信、半双工通信、全双工通信

基带信号

调制方法	调幅调频，调相

编码方式 单/双极性归零码、单/双级不归零码、曼彻特斯编码，差分曼彻特斯编码

信道极限容量，奈氏准则：没有信号干扰的情况下，码元传输的上限也是有限度的

​						 香农公式：有信号干扰，无差错传输







#### 物理层传输媒体

导向传输媒体，电磁波沿着固体媒体传播
双绞线

- 屏蔽双绞线 STP

- 无屏蔽双绞线UTP

  同轴电缆
  50 Q同轴电缆用于数字传输，由于多用于基带传输，也叫基带同轴电缆;
  75Q同轴电缆用于模拟传输，即宽带同轴电缆。

![](/QQ截图20191007224025.png)

**光纤**

光在光纤中的介质中不断的折射传输，最终到达目标计算机

单模光纤指只能传输一种电磁波模式，多模光纤只可以传输多个电磁波模式，实际上单模光纤和多模光纤之分，也就是纤芯的直径之分。单模光纤细，多模光纤粗。在有线电视网络中使用的光纤全是单模光纤，其传播特性好，带宽可达10GHZ，可以在一根光纤中传输60套PAL- _D电视节目。

非导向传输媒体.
非导向传输媒体就是指自由空间，其中的电磁波传输被称为
无线传输。
无线传输所使用的频段很广。
短波通信主要是靠电离层的反射，但短波信道的通信质量较
差。
微波在空间主要是直线传播。
地面微波接力通信

卫星通信



##### 物理层设备——集线器

工作特点：在网络中只是起到信号放到和重发作用，目的是扩大网络的传输范围，但不具备信号的**定向传送能力**

最大传输距离：100m



#### 信道复用技术

**复用**是通信技术的基本概念

假设一条100m的光纤，可以开辟一条信道给A与外界打电话通信，也可以开辟另一条信道给另一个B观看视频。诸如此类，一条光纤有很多条信道供用户使用，之间的通信互不干扰互不影响

![](/QQ截图20191007231512.png)

##### 信道复用技术

频分复用：用户在分配到一定的频带后，在通信过程中自始至终都占用这个频带



### TCP/IP协议

参考文章：<https://juejin.im/post/5a069b6d51882509e5432656>

#### 计算机网络结构分层结构

![](/690219fae5b0587fa26e2dee545e6200)



![](138bd1a9db5818b02d613d6b833da594)

具体来说，IP 或 ICMP、TCP 或 UDP、TELNET 或 FTP、以及 HTTP 等都属于 TCP/IP 协议，TCP/IP 一词泛指这些协议，因此，有时也称 TCP/IP 为网际协议群。

#### 数据包

**包、帧、数据包、段、消息**
以上五个术语都用来表述数据的单位，大致区分如下：

- 包可以说是全能性术语；
- 帧用于表示数据链路层中包的单位；
- 数据包是 IP 和 UDP 等网络层以上的分层中包的单位；
- 段则表示 TCP 数据流中的信息；
- 消息是指应用协议中数据的单位。

#### 数据传输处理

![](b3017842bdddd50386f54ffd64d5491c)



#### 通过IP、端口、传输协议通信识别

在Java开发中，很多时候我们仅仅需要端口号和IP地址就能实现服务之间的通讯，因为绝大部分情况下，框架封装了这些协议，而且绝大部分的网络编程，都可以说是TCP编程

![](QQ截图20200413213239.png)

① 和② 的通信是在两台计算机上进行的。它们的目标端口号相同，都是80。这里可以根据源端口号加以区分。

③ 和 ① 的目标端口号和源端口号完全相同，但它们各自的源 IP 地址不同。

此外，当 IP 地址和端口号全都一样时，我们还可以通过协议号来区分（TCP 和 UDP）。



#### TCP和UDP区别

- UDP是面向无连接，不可靠协议，传输数据限制大小为64kb，不管接受端有没有接受到数据 ，会出现丢包现象，且不负责重发

  UDP 常用于一下几个方面：1.包总量较少的通信（DNS、SNMP等）；2.视频、音频等多媒体通信（即时通信）；3.限定于 LAN 等特定网络中的应用通信；4.广播通信（广播、多播）

- TCP是面向连接，安全可靠的协议，需要双方之间建立起连接，只有在客户端存在的时候才会进行数据的传输，遇到丢包会重发，由于IP协议是无连接的网络协议，在基于TCP可靠传输协议就能建立起一对一的的可靠的通信

  TCP的应用场景：文件的传输、安全数据的通信

#### TCP三次握手

- TCP 提供面向有连接的通信传输。面向有连接是指在数据通信开始之前先做好两端之间的准备工作。
- 所谓三次握手是指建立一个 TCP 连接时需要客户端和服务器端总共发送三个包以确认连接的建立。在socket编程中，这一过程由客户端执行connect来触发。

![图片已丢失](710ec8e91690b573ce62e62eebf2885a)

- 第一次握手：客户端将标志位SYN置为1，随机产生一个值seq=J，并将该数据包发送给服务器端，客户端进入SYN_SENT状态，等待服务器端确认。

- 第二次握手：服务器端收到数据包后由标志位SYN=1知道客户端请求建立连接，服务器端将标志位SYN和ACK都置为1，ack=J+1，随机产生一个值seq=K，并将该数据包发送给客户端以确认连接请求，服务器端进入SYN_RCVD状态。

- 第三次握手：客户端收到确认后，检查ack是否为J+1，ACK是否为1，如果正确则将标志位ACK置为1，ack=K+1，并将该数据包发送给服务器端，服务器端检查ack是否为K+1，ACK是否为1，如果正确则连接建立成功，客户端和服务器端进入ESTABLISHED状态，完成三次握手，随后客户端与服务器端之间可以开始传输数据了。

#### TCP四次挥手

![](c901e0fd0aaae817df400b1b989a9351)

